{"hash":"d89482cf8a02b778a4f607292cf99f174c3054d9","data":{"markdownPage":{"id":"857eb3d38ae67f6bc03a7ae983c1cc79","title":"uEngine5 기반 프로젝트 만들기","description":"","path":"/uengine/","timeToRead":2,"content":"<h1 id=\"uengine5-기반-프로젝트-만들기\"><a href=\"#uengine5-%EA%B8%B0%EB%B0%98-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EB%A7%8C%EB%93%A4%EA%B8%B0\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>uEngine5 기반 프로젝트 만들기</h1>\n<p><strong>먼저, uEngine-default 프로젝트를 복제한다:</strong></p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> clone https://github.com/TheOpenCloudEngine/uEngine5-default.git</code></pre>\n<p><strong>복제한 uEngine-default 프로젝트를 해당 사이트의 프로젝트 명으로 전환한다:</strong></p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">mv</span> uEngine5-default someproject\n<span class=\"token builtin class-name\">cd</span> someproject</code></pre>\n<p><strong>pom.xml 내의 프로젝트에 대한 설명 정보도 바꿔 준다:</strong></p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token operator\">&lt;</span>groupId<span class=\"token operator\">></span>com.company<span class=\"token operator\">&lt;</span>/groupId<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>artifactId<span class=\"token operator\">></span>bpm-project<span class=\"token operator\">&lt;</span>/artifactId<span class=\"token operator\">></span></code></pre>\n<p><strong>그런다음 빌드를 실시한다:</strong></p>\n<pre class=\"language-bash\"><code class=\"language-bash\">mvn spring-boot:run</code></pre>\n<h2 id=\"설정-변경과-커스터마이징\"><a href=\"#%EC%84%A4%EC%A0%95-%EB%B3%80%EA%B2%BD%EA%B3%BC-%EC%BB%A4%EC%8A%A4%ED%84%B0%EB%A7%88%EC%9D%B4%EC%A7%95\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>설정 변경과 커스터마이징</h2>\n<p><strong>WebConfig.java</strong></p>\n<pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>uengine<span class=\"token punctuation\">.</span>five</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n\n<span class=\"token annotation punctuation\">@EnableWebMvc</span>\n<span class=\"token annotation punctuation\">@Configuration</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">WebConfig</span> <span class=\"token keyword\">extends</span> org<span class=\"token punctuation\">.</span>uengine<span class=\"token punctuation\">.</span>social<span class=\"token punctuation\">.</span>uEngine5WebConfig <span class=\"token punctuation\">{</span>\n\n\n    <span class=\"token doc-comment comment\">/**\n     * Uncomment and implement if you want to change default storage\n     */</span>\n<span class=\"token comment\">//    @Bean</span>\n<span class=\"token comment\">//    @Override</span>\n<span class=\"token comment\">//    public Storage storage() {</span>\n<span class=\"token comment\">//        CLOBStorage storage = new CLOBStorage();</span>\n<span class=\"token comment\">//        storage.setDataSource(dataSource());</span>\n<span class=\"token comment\">//        storage.setTableName(\"bpm_def\");</span>\n<span class=\"token comment\">//</span>\n<span class=\"token comment\">//        return storage;</span>\n<span class=\"token comment\">//    }</span>\n\n\n    <span class=\"token doc-comment comment\">/**\n     * Uncomment and add ActivityFilters like following example\n     */</span>\n<span class=\"token comment\">//    @Bean</span>\n<span class=\"token comment\">//    public ActivityFilter exampleActivityFilter1() {</span>\n<span class=\"token comment\">//        return new ExampleActivityFilter1();</span>\n<span class=\"token comment\">//    }</span>\n<span class=\"token comment\">//</span>\n<span class=\"token comment\">//    @Bean</span>\n<span class=\"token comment\">//    public ActivityFilter exampleActivityFilter2() {</span>\n<span class=\"token comment\">//        return new ExampleActivityFilter2();</span>\n<span class=\"token comment\">//    }</span>\n<span class=\"token comment\">//</span>\n\n    <span class=\"token doc-comment comment\">/**\n     * Uncomment and return an implementation of ProcessInstance. default is JPAProcessInstance\n     */</span>\n<span class=\"token comment\">//    @Bean</span>\n<span class=\"token comment\">//    @Scope(\"prototype\")</span>\n<span class=\"token comment\">//    @Override</span>\n<span class=\"token comment\">//    public ProcessInstance processInstance(ProcessDefinition procDefinition, String instanceId, Map options) throws Exception {</span>\n<span class=\"token comment\">//        return new CustomProcessInstance(procDefinition, instanceId, options);</span>\n<span class=\"token comment\">//    }</span>\n\n    <span class=\"token doc-comment comment\">/**\n     * Uncomment and return an real datasource not the H2\n     */</span>\n\n    <span class=\"token annotation punctuation\">@Bean</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">DataSource</span> <span class=\"token function\">dataSource</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">//In classpath from spring-boot-starter-web</span>\n        <span class=\"token keyword\">final</span> <span class=\"token class-name\">Properties</span> pool <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Properties</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        pool<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"driverClassName\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"com.mysql.jdbc.Driver\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        pool<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"url\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"jdbc:mysql://localhost:3306/uengine?useUnicode=true&amp;characterEncoding=UTF8&amp;useOldAliasMetadataBehavior=true\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        pool<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"username\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"root\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        pool<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"password\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        pool<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"minIdle\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>tomcat<span class=\"token punctuation\">.</span>jdbc<span class=\"token punctuation\">.</span>pool<span class=\"token punctuation\">.</span><span class=\"token class-name\">DataSourceFactory</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">createDataSource</span><span class=\"token punctuation\">(</span>pool<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeException</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span></code></pre>\n<p><strong>위의 예제는 각각 저장 매체, 액티비티 필터 설치, 접속데이터베이스 (기본은 H2 DB) 변경에 대한 샘플이다.</strong></p>\n<ul>\n<li>예를 들어, 저장매체를 변경한다면,</li>\n</ul>\n<pre class=\"language-java\"><code class=\"language-java\">    <span class=\"token annotation punctuation\">@Bean</span>\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Storage</span> <span class=\"token function\">storage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">AmazonS3Storage</span> storage <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AmazonS3Storage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        storage<span class=\"token punctuation\">.</span><span class=\"token function\">setAmazonS3Bucket</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"bucketName\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        storage<span class=\"token punctuation\">.</span><span class=\"token function\">setAwsAccessKey</span><span class=\"token punctuation\">(</span>ACCESS_KEY<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        storage<span class=\"token punctuation\">.</span><span class=\"token function\">setAwsSecretAccessKey</span><span class=\"token punctuation\">(</span>SECRET<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        \n        <span class=\"token keyword\">return</span> storage<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span></code></pre>\n<ul>\n<li>사용할 수 있는 저장매체로는 LocalFileStorage, AmazonS3Storage, CouchbaseStorage 등을 사용할 수 있고, 직접 구현하여 CLOB 기반 저장소, git 버전관리 기반 저장소 등을 만들어 쓰면 된다.</li>\n<li>액티비티 필터는 하나 이상을 선언해서 쓰면 된다, 호출 순서는 Spring에서 알아서 정할 것이기 때문에 (리플랙션으로) 잘 모르겠다. (헐) :</li>\n</ul>\n<pre class=\"language-java\"><code class=\"language-java\">    <span class=\"token annotation punctuation\">@Bean</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">ActivityFilter</span> <span class=\"token function\">exampleActivityFilter1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ExampleActivityFilter1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Bean</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">ActivityFilter</span> <span class=\"token function\">exampleActivityFilter2</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ExampleActivityFilter2</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span></code></pre>\n<ul>\n<li>액티비티 필터가 뭐하는 거냐고 묻는다면 모든 프로세스와 액티비티 실행시 거쳐가는 리스너의 개념으로 (프로세스 실행에 제약을 줄 수 있는 권한은 없으므로 어째보면 정확히 필터는 아니고 리스너에 가깝다. 처음에 네이밍을 잘못했네 이사람아..)</li>\n</ul>\n<pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>uengine<span class=\"token punctuation\">.</span>kernel</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token doc-comment comment\">/**\n * <span class=\"token keyword\">@author</span> Jinyoung Jang\n */</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">ActivityFilter</span> <span class=\"token keyword\">extends</span> java<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span><span class=\"token class-name\">Serializable</span><span class=\"token punctuation\">{</span>\n\t<span class=\"token comment\">//run-time</span>\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">beforeExecute</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Activity</span> activity<span class=\"token punctuation\">,</span> <span class=\"token class-name\">ProcessInstance</span> instance<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">afterExecute</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Activity</span> activity<span class=\"token punctuation\">,</span> <span class=\"token class-name\">ProcessInstance</span> instance<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">afterComplete</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Activity</span> activity<span class=\"token punctuation\">,</span> <span class=\"token class-name\">ProcessInstance</span> instance<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">onPropertyChange</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Activity</span> activity<span class=\"token punctuation\">,</span> <span class=\"token class-name\">ProcessInstance</span> instance<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> propertyName<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span> changedValue<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span><span class=\"token punctuation\">;</span>\n\t\n\t<span class=\"token comment\">//deploy time</span>\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">onDeploy</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ProcessDefinition</span> definition<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n","sidebar":"uengine","next":"","prev":"","headings":[{"depth":1,"value":"uEngine5 기반 프로젝트 만들기","anchor":"#uengine5-기반-프로젝트-만들기"},{"depth":2,"value":"설정 변경과 커스터마이징","anchor":"#설정-변경과-커스터마이징"}]},"allMarkdownPage":{"edges":[{"node":{"path":"/uengine/sidebar/","title":"uEngine5 API Reference"}},{"node":{"path":"/uengine/writing-content/","title":"uEngine3.x 에서 uEngine5 로의 마이그래이션"}},{"node":{"path":"/uengine/deploying/","title":"uEngine5 트랜잭션 리스너"}},{"node":{"path":"/uengine/","title":"uEngine5 기반 프로젝트 만들기"}},{"node":{"path":"/uengine/installation/","title":"새로운 액티비티 타입 만들기"}},{"node":{"path":"/group/settings/","title":"Facebook group"}}]}},"context":{}}